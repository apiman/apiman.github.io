<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="msvalidate.01" content="C3BF2C67B92C75F2DEAA096973652038" />
  <link rel="shortcut icon" href="http://www.apiman.io/latest/resources/images/favicon.ico">
  <title>Apiman 1.2.1 Export and Import | apiman Open Source API Management</title>
  <meta name="description" content="The Question you DreadIf you use a computer at home or at work, you’ll eventually find yourself in a situation where you lose some important data and, while ...">

  <!-- CSS -->
  <link href="http://www.apiman.io/latest/resources/bootstrap-3.3.0/css/bootstrap.min.css" rel="stylesheet">
  <link href="http://www.apiman.io/latest/resources/patternfly-1.0.5/css/patternfly.min.css" rel="stylesheet">
  <link href="http://static.jboss.org/css/rhbar.css" media="screen" rel="stylesheet">
  <link href="http://www.apiman.io/latest/resources/css/apiman-web.css?v=1.2.7.Final" rel="stylesheet">
  <link href="http://www.apiman.io/latest/resources/css/apiman-web.responsive.css?v=1.2.7.Final" rel="stylesheet">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="/blog/css/highlight.css" rel="stylesheet">
  <link href="/blog/css/main.css" rel="stylesheet">
  <link href="/blog/css/coderay-asciidoctor.css" rel="stylesheet">


  <!-- Scripts -->

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
  
  <script src="http://www.apiman.io/latest/resources/jquery-1.11.1/js/jquery.min.js"></script>
  <script src="http://www.apiman.io/latest/resources/bootstrap-3.3.0/js/bootstrap.min.js"></script>
  <script id="dsq-count-scr" src="//apiman.disqus.com/count.js" async></script>

  <!-- Canonical URL -->
    
    <link rel="canonical" href="http://apiman.io/blog/apiman/introduction/overview/backup/export/import/2016/01/27/export-import.html">
    

  <link rel="alternate" type="application/rss+xml" title="apiman Blog | Open Source API Management" href="http://apiman.io/blog/feed.xml" />


  <!-- Google Analytics -->
  <script>
    $(document).ready(function() {
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-56678850-1', 'auto');
      ga('send', 'pageview');
    });
  </script>
</head>

  <body class="blog">
    <div id="rhbar">
      <a class="jbdevlogo" href="http://www.jboss.org/projects/about" rel="nofollow" target="_blank"></a>
      <a class="rhlogo" href="http://www.redhat.com/" rel="nofollow" target="_blank"></a>
    </div>
    <nav id="top-nav" class="navbar navbar-inverse" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="http://www.apiman.io/latest/index.html">apiman</a>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li class="top-menu-item menu-item"><a href="http://www.apiman.io/latest/index.html">Overview</a></li>
        <li class="top-menu-item menu-item"><a href="http://www.apiman.io/latest/download.html">Download</a></li>
        <li class="top-menu-item menu-item"><a href="http://www.apiman.io/latest/roadmap.html">Roadmap</a></li>
        <li class="top-menu-item menu-item active"><a href="http://www.apiman.io/blog/">Blog</a></li>
        <li class="top-menu-item menu-item dropdown">
            <a href="" class="dropdown-toggle" data-toggle="dropdown">Get Involved<b class="caret"></b></a>
            <ul class="dropdown-menu">
                <li class="menu-item">
                    <a href="https://issues.jboss.org/browse/APIMAN">Report a Bug</a>
                </li>
                <li class="menu-item">
                    <a href="http://www.apiman.io/latest/chat.html">Chat on IRC</a>
                </li>
                <li class="menu-item">
                    <a href="https://twitter.com/apiman_io" rel="nofollow" target="_blank">Twitter Feed</a>
                </li>
                <li class="menu-item">
                    <a href="https://lists.jboss.org/mailman/listinfo/apiman-user" rel="nofollow" target="_blank">Mailing List</a>
                </li>
                <li class="divider"></li>
                <li class="menu-item">
                    <a href="http://www.apiman.io/latest/contributors.html">Contributors List</a>
                </li>
            </ul>
        </li>
        <li class="top-menu-item menu-item dropdown">
            <a href="" class="dropdown-toggle" data-toggle="dropdown">Learn More<b class="caret"></b></a>
            <ul class="dropdown-menu">
                <li class="menu-item">
                    <a href="http://www.apiman.io/latest/tutorials.html">Tutorials &amp; Walkthroughs</a>
                </li>
                <li class="menu-item">
                    <a href="http://www.apiman.io/latest/crash-course.html">Crash Course!</a>
                </li>
                <li class="divider"></li>
                <li class="menu-item">
                    <a href="http://www.apiman.io/latest/installation-guide.html">Installation Guide</a>
                </li>
                <li class="menu-item">
                    <a href="http://www.apiman.io/latest/user-guide.html">User Guide</a>
                </li>
                <li class="menu-item">
                    <a href="http://www.apiman.io/latest/developer-guide.html">Developer Guide</a>
                </li>
                <li class="menu-item">
                    <a href="http://www.apiman.io/latest/production-guide.html">Production Guide</a>
                </li>
                <li class="divider"></li>
                <li class="menu-item">
                    <a href="http://www.apiman.io/latest/api-manager-restdocs.html">API Manager REST Endpoints</a>
                </li>
            </ul>
        </li>
      </ul>
    </div><!--/.nav-collapse -->
  </div>
</nav>


    <div class="container" id="blog">
      <div class="blog-content">
        

<div class="post">
  <header class="post-header" style="margin-top: 25px">
    <h1 style="color: #666; font-weight: bold" class="post-title section-header">Apiman 1.2.1 Export and Import</h1>
    <span style="color: #243446; font-size: 13px"><i class="fa fa-calendar"></i> Jan 27, 2016</span>
    <span style="color: #243446; margin-left: 15px; font-size: 13px"><i class="fa fa-user"></i> <a href="https://github.com/ldimaggi">Len DiMaggio</a></span>
    <span style="color: #243446; margin-left: 15px; font-size: 13px"><i class="fa fa-tags"></i> apiman, introduction, overview, backup, export, and import</span>
  </header>


  

  

  <article class="post-content"
           style="margin-top: 20px; font-size: 14px; line-height: 20px">
    <h3 id="the-question-you-dread">The Question you Dread</h3>

<p>If you use a computer at home or at work, you’ll eventually find yourself in a situation where you lose some important data and, while you are trying to recover it, someone asks you a question that is simultaneously annoying and terrifying:</p>

<p><em>“Did you make a backup?”</em></p>

<p>Happily, the 1.2 release of apiman includes a new feature that enables you to export and import your apiman data and provides you with an easy means to create apiman data backups.  In this post,  we’ll take a look at the new export/import feature, and how you can use it for a variety of tasks to protect your data, make your life easier, and enable you to avoid annoying and terrifying questions.</p>

<!--more-->

<p>For test data, we’ll use the same types of data (organizations, users, plans, policies, APIs and client apps), that we created in the initial post in this series. (  <a href="http://www.apiman.io/blog/introduction/overview/2015/01/09/impatient-new-user-redux.html">The Impatient New User Guide to apiman</a> )</p>

<p>Note that since that post was written in January 2015, some of the names of the data elements have changed. You can either create the test data referred to in this post yourself, or you can import the data file attached to the post.</p>

<h3 id="exportimport-in-apiman-121">Export/Import in apiman 1.2.1</h3>

<p>The new export/import feature in apiman 1.2.1 enables you to export your apiman configuration data to a file, which can later be imported into an apiman system. Note that this feature follows an all-or-nothing approach in that is does not support incremental backup and restore of selected apiman data.</p>

<p>The three main use cases that the export/import feature supports are:</p>

<ul>
  <li>Backing up all your apiman data</li>
  <li>Upgrading to a newer version of apiman</li>
  <li>Migrating apiman data from a Test environment to a Production environment</li>
</ul>

<p>The export/import operations are only available to Administrative users. The export/import feature is accessed through the admin operations menu:</p>

<p><img src="/blog/images/2016-01-26/export_import_1.png" alt="Image: Admin Choices" /></p>

<p>Once you select the <strong>Export/Import</strong> Data feature, this menu is displayed:</p>

<p><img src="/blog/images/2016-01-26/export_import_2.png" alt="Image: Export/Import Menu" /></p>

<p>One thing to keep in mind is that while you are importing or exporting data, no changes to data should be made or else the export/import may encounter an error, or may result in incomplete results. To be safe, you should disable user access to the API Manager, both the Management UI and its REST interface, for the duration of the import or export operation.</p>

<p>We’ll look at exporting data first.</p>

<h3 id="backing-up-apiman-data">Backing up apiman Data</h3>

<p>To make a backup of all your apiman data, simply select the “Export All” button. The apiman data will be written to a file and downloaded by your browser. Your browser’s settings will determine where the file is saved.</p>

<p>The apiman data is written to a file named: api-manager-export.json</p>

<p>As its name indicates, the apiman data is written in JSON form. This format provides us with  several advantages. First of all, it’s the format in which apiman is able to import data. (We’ll perform an import later in this post.) Secondly, it’s a text file where the contents of the file are human readable. The content of the file is ALL the apiman data, both the data elements that you have created and the data elements with which apiman is preconfigured.</p>

<p>Reading this file can greatly increase your understanding of the elements that are defined in apiman. Let’s take a look at the elements in the file:</p>

<ul>
  <li><strong>Users</strong> - The preconfigured “admin” user is defined here, as are the new users we create.</li>
  <li><strong>Gateways</strong> - The preconfigured apiman Gateway is defined here.</li>
  <li><strong>Roles</strong> - The preconfigured, permission-based roles, and new roles that we create, are defined here. For example, the “OrganizationOwner” role is shown to have these permissions: [ “apiAdmin”, “orgAdmin”, “apiView”, “orgEdit”, “clientEdit”, “clientAdmin”, “planView”, “orgView”, “planAdmin”, “clientView”, “planEdit”, “apiEdit” ]</li>
  <li><strong>Policy Definitions</strong> -  Next, the preconfigured policies, and new policies t2015-11-12-micro-services.markdownhat we create, are defined here. For example: the “RateLimitingPolicy” is described as “Enforces rate configurable request rate limits on an API.  This ensures that consumers can’t overload an API with too many requests.”</li>
  <li>The remainder of the file includes the elements that we create: <strong>Organizations, Plans, APIs, and Client Apps</strong>. For example, here is the definition of the “echo” API that we created:</li>
</ul>

<div class="highlighter-coderay"><div class="CodeRay">
  <div class="code"><pre><span class="line-numbers"> <a href="#n1" name="n1">1</a></span><span style="color:#606"><span style="color:#404">"</span><span>Apis</span><span style="color:#404">"</span></span> : [ {
<span class="line-numbers"> <a href="#n2" name="n2">2</a></span>  <span style="color:#606"><span style="color:#404">"</span><span>ApiBean</span><span style="color:#404">"</span></span> : {
<span class="line-numbers"> <a href="#n3" name="n3">3</a></span>  <span style="color:#606"><span style="color:#404">"</span><span>id</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">echo</span><span style="color:#710">"</span></span>,
<span class="line-numbers"> <a href="#n4" name="n4">4</a></span>  <span style="color:#606"><span style="color:#404">"</span><span>name</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">echo</span><span style="color:#710">"</span></span>,
<span class="line-numbers"> <a href="#n5" name="n5">5</a></span>  <span style="color:#606"><span style="color:#404">"</span><span>description</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">The echo API</span><span style="color:#710">"</span></span>,
<span class="line-numbers"> <a href="#n6" name="n6">6</a></span>  <span style="color:#606"><span style="color:#404">"</span><span>createdBy</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">serprov</span><span style="color:#710">"</span></span>,
<span class="line-numbers"> <a href="#n7" name="n7">7</a></span>  <span style="color:#606"><span style="color:#404">"</span><span>createdOn</span><span style="color:#404">"</span></span> : <span style="color:#00D">1453773184836</span>,
<span class="line-numbers"> <a href="#n8" name="n8">8</a></span>  <span style="color:#606"><span style="color:#404">"</span><span>numPublished</span><span style="color:#404">"</span></span> : <span style="color:#00D">1</span>
<span class="line-numbers"> <a href="#n9" name="n9">9</a></span> },
<span class="line-numbers"><strong><a href="#n10" name="n10">10</a></strong></span> <span style="color:#606"><span style="color:#404">"</span><span>Versions</span><span style="color:#404">"</span></span> : [ {
<span class="line-numbers"><a href="#n11" name="n11">11</a></span>  <span style="color:#606"><span style="color:#404">"</span><span>ApiVersionBean</span><span style="color:#404">"</span></span> : {
<span class="line-numbers"><a href="#n12" name="n12">12</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>id</span><span style="color:#404">"</span></span> : <span style="color:#00D">10</span>,
<span class="line-numbers"><a href="#n13" name="n13">13</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>status</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">Published</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n14" name="n14">14</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>endpoint</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">http://localhost:8080/apiman-echo</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n15" name="n15">15</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>endpointType</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">rest</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n16" name="n16">16</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>endpointContentType</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">json</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n17" name="n17">17</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>endpointProperties</span><span style="color:#404">"</span></span> : { },
<span class="line-numbers"><a href="#n18" name="n18">18</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>gateways</span><span style="color:#404">"</span></span> : [ {
<span class="line-numbers"><a href="#n19" name="n19">19</a></span>      <span style="color:#606"><span style="color:#404">"</span><span>gatewayId</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">TheGateway</span><span style="color:#710">"</span></span>
<span class="line-numbers"><strong><a href="#n20" name="n20">20</a></strong></span>    } ],
<span class="line-numbers"><a href="#n21" name="n21">21</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>publicAPI</span><span style="color:#404">"</span></span> : <span style="color:#088">false</span>,
<span class="line-numbers"><a href="#n22" name="n22">22</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>plans</span><span style="color:#404">"</span></span> : [ {
<span class="line-numbers"><a href="#n23" name="n23">23</a></span>      <span style="color:#606"><span style="color:#404">"</span><span>planId</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">gold</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n24" name="n24">24</a></span>      <span style="color:#606"><span style="color:#404">"</span><span>version</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">1.0</span><span style="color:#710">"</span></span>
<span class="line-numbers"><a href="#n25" name="n25">25</a></span>    } ],
<span class="line-numbers"><a href="#n26" name="n26">26</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>version</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">1.0</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n27" name="n27">27</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>createdBy</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">serprov</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n28" name="n28">28</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>createdOn</span><span style="color:#404">"</span></span> : <span style="color:#00D">1453773184845</span>,
<span class="line-numbers"><a href="#n29" name="n29">29</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>modifiedBy</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">serprov</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><strong><a href="#n30" name="n30">30</a></strong></span>    <span style="color:#606"><span style="color:#404">"</span><span>modifiedOn</span><span style="color:#404">"</span></span> : <span style="color:#00D">1453773312563</span>,
<span class="line-numbers"><a href="#n31" name="n31">31</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>publishedOn</span><span style="color:#404">"</span></span> : <span style="color:#00D">1453773327835</span>
<span class="line-numbers"><a href="#n32" name="n32">32</a></span>  },
<span class="line-numbers"><a href="#n33" name="n33">33</a></span>  <span style="color:#606"><span style="color:#404">"</span><span>Policies</span><span style="color:#404">"</span></span> : [ {
<span class="line-numbers"><a href="#n34" name="n34">34</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>id</span><span style="color:#404">"</span></span> : <span style="color:#00D">14</span>,
<span class="line-numbers"><a href="#n35" name="n35">35</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>type</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">Api</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n36" name="n36">36</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>organizationId</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">ACMEServices</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n37" name="n37">37</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>entityId</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">echo</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n38" name="n38">38</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>entityVersion</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">1.0</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n39" name="n39">39</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>name</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">BASIC Authentication Policy</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><strong><a href="#n40" name="n40">40</a></strong></span>    <span style="color:#606"><span style="color:#404">"</span><span>configuration</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">{</span><span style="color:#b0b">\"</span><span style="color:#D20">realm</span><span style="color:#b0b">\"</span><span style="color:#D20">:</span><span style="color:#b0b">\"</span><span style="color:#D20">Echo</span><span style="color:#b0b">\"</span><span style="color:#D20">,</span><span style="color:#b0b">\"</span><span style="color:#D20">requireBasicAuth</span><span style="color:#b0b">\"</span><span style="color:#D20">:false,</span><span style="color:#b0b">\"</span><span style="color:#D20">staticIdentity</span><span style="color:#b0b">\"</span><span style="color:#D20">:{</span><span style="color:#b0b">\"</span><span style="color:#D20">identities</span><span style="color:#b0b">\"</span><span style="color:#D20">:[{</span><span style="color:#b0b">\"</span><span style="color:#D20">username</span><span style="color:#b0b">\"</span><span style="color:#D20">:</span><span style="color:#b0b">\"</span><span style="color:#D20">user1</span><span style="color:#b0b">\"</span><span style="color:#D20">,</span><span style="color:#b0b">\"</span><span style="color:#D20">password</span><span style="color:#b0b">\"</span><span style="color:#D20">:</span><span style="color:#b0b">\"</span><span style="color:#D20">admin123!</span><span style="color:#b0b">\"</span><span style="color:#D20">}]}}</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n41" name="n41">41</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>createdBy</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">serprov</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n42" name="n42">42</a></span>    <span style="color:#606"><span style="color:#404">"</span><span>createdOn</span><span style="color:#404">"</span></span> : <span style="color:#00D">1453773312553</span>,
<span class="line-numbers"><a href="#n43" name="n43">43</a></span>     <span style="color:#606"><span style="color:#404">"</span><span>modifiedBy</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">serprov</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n44" name="n44">44</a></span>     <span style="color:#606"><span style="color:#404">"</span><span>modifiedOn</span><span style="color:#404">"</span></span> : <span style="color:#00D">1453773312553</span>,
<span class="line-numbers"><a href="#n45" name="n45">45</a></span>     <span style="color:#606"><span style="color:#404">"</span><span>definition</span><span style="color:#404">"</span></span> : {
<span class="line-numbers"><a href="#n46" name="n46">46</a></span>      <span style="color:#606"><span style="color:#404">"</span><span>id</span><span style="color:#404">"</span></span> : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">"</span><span style="color:#D20">BASICAuthenticationPolicy</span><span style="color:#710">"</span></span>,
<span class="line-numbers"><a href="#n47" name="n47">47</a></span>      <span style="color:#606"><span style="color:#404">"</span><span>templates</span><span style="color:#404">"</span></span> : [ ],
<span class="line-numbers"><a href="#n48" name="n48">48</a></span>      <span style="color:#606"><span style="color:#404">"</span><span>deleted</span><span style="color:#404">"</span></span> : <span style="color:#088">false</span>
<span class="line-numbers"><a href="#n49" name="n49">49</a></span>    },
<span class="line-numbers"><strong><a href="#n50" name="n50">50</a></strong></span>    <span style="color:#606"><span style="color:#404">"</span><span>orderIndex</span><span style="color:#404">"</span></span> : <span style="color:#00D">1</span>
<span class="line-numbers"><a href="#n51" name="n51">51</a></span>  } ]
</pre></div>
</div>
</div>

<p>One thing to remember is that the exported data file represents ALL apiman data. It’s not yet possible to perform incremental data backups in apiman. If you attempt to import the data from this file into the same apiman installation from which it was generated, you will see unique primary key violations as the import operation will attempt to create duplicate data elements.</p>

<p>OK, now that we have this exported data file, what can we do with it?</p>

<p>Well, obviously, if something goes wrong with your installation of apiman, you can start over with a clean installation, and instead of manually recreating your data, you can import the data. (Personal note from the author: I work in software test/QE. Part of our testing is always destructive in nature. As a result, we are always “messing up” test data. The export/import feature enables us to quickly reinstall apiman and recover a clean test environment.) To perform the import after a new installation of apiman, you simply select and upload  the exported data file:</p>

<p><img src="/blog/images/2016-01-26/export_import_3.png" alt="Image: Admin Choices" /></p>

<p>The Management UI displays the status of the import as the data is processed:</p>

<p><img src="/blog/images/2016-01-26/export_import_4.png" alt="Image: Admin Choices" /></p>

<p>How else can we use the exported data file?</p>

<h3 id="upgrading-to-a-newer-version-of-apiman">Upgrading to a Newer Version of apiman</h3>

<p>One of the best aspects of open source projects is the rapid rate at which new features are implemented and new versions are released. It’s exciting to watch projects quickly mature as features are added and bugs are fixed, and since the projects are open source, you can even make your own contributions. This has been the case with apiman over the past several months. New features have been added such as metrics and support for creating custom policies.</p>

<p>One downside to all the rapid change is that as new versions of apiman have been released, we’ve had to recreate all our apiman data as there was no way to migrate apiman data from one release to the next. The export/import feature now gives us a way to export apiman data from one apiman release and import it into a new apiman release.</p>

<p>NOTE: In cases where the apiman data model changes between versions, apiman will introduce tools to transform the JSON export file from an older format to the latest.  It has not yet been decided whether those tools will be built into the Import process, or released as a standalone utility.</p>

<h3 id="migrating-apiman-data-from-a-test-environment-to-a-production-environment">Migrating apiman Data from a <em>Test</em> Environment to a <em>Production</em> Environment</h3>

<p>It’s a common practice for organizations to maintain two separate installations of software releases:</p>

<p>A test environment, where the goal is to experiment with new features. This is typically an internal environment that gives up some measure of stability in exchange for the ability to “try out” new features as they become available. The rate of change for this environment is high as any disruption in service in this environment do not affect customers.
A production environment, where the goal is stability. This is the environment that supports your customers. Changes happen slowly in this environment and new features are only installed after they are carefully tested as disruptions in service in this environment do affect customers.</p>

<p>The new export/import feature in apiman 1.2 makes it possible for you to experiment with changes in your test environment, and, after the changes have been found to be stable, to easily migrate your test data from the test environment into your production environment. (You will, of course, create a backup of your production environment data before making any changes.  ;-)</p>

<h3 id="migrating-apiman-from-one-storage-solution-to-another">Migrating apiman from one storage solution to another</h3>

<p>Finally, when apiman is first installed, you must make various decisions about its configuration.  One of these decisions is where to store configuration and data.  When you first install apiman, you might decide that MySQL is the right choice.  However, somewhere along the line you might change your mind - perhaps you want to switch to postgresql, or even more drastically you might switch to Elasticsearch!  The Export/Import process described here solves the problem of how to migrate all your data from one storage location to another.</p>

<p>The process is basically the same as upgrading to a newer version of apiman.  But instead you will be upgrading to the same version of apiman, but with a different configuration.  Because the exported data is in a neutral (JSON) format, we can easily import into the new configuration.  This will result in all your data being migrated from MySQL to Elasticsearch (for example).</p>

<h3 id="in-conclusion">In Conclusion</h3>

<p>The new export/import feature in apiman 1.2 provides an easy way to safeguard your apiman data and to make it possible to migrate your data between apiman releases and installations. In addition, since the exported data is human readable, it is a great resource for better understanding apiman data structures. And, it’s easy to use too!</p>

<p>/post</p>


  </article>

  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        this.page.url = '';
        this.page.identifier = '/apiman/introduction/overview/backup/export/import/2016/01/27/export-import';
    };

    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//apiman.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


</div>

      </div>
      <div class="blog-footer">
        <footer role="contentinfo">
    <div id="inner-footer" class="clearfix row">
        <div id="widget-footer" class="clearfix">
            <hr>
            <div class="widget col-sm-6 col-md-6 widget_text">
                <div class="textwidget">
                    <p>
                        Copyright &copy; 2017 Red Hat, Inc. All rights reserved.<br>
                        apiman code is open source and released under <a href="http://www.apache.org/licenses/LICENSE-2.0.html" rel="nofollow" target="_blank">Apache License, v2.0</a>.<br>
                        <a href="/latest/disclosure.html">Open Source Disclosure</a>
                    </p>
                </div>
            </div>
            <div class="widget col-sm-6 col-md-6 widget_text" style="text-align: right">
                <a href="http://www.redhat.com" rel="nofollow" target="_blank"><img src="http://static.jboss.org/theme/images/common/redhat_logo.png" alt="Red Hat"></a>
            </div>
        </div>
        <nav class="clearfix"></nav>
    </div>

    <!-- Adobe Analytics -->
    <script src="//www.redhat.com/j/s_code.js" />
    <script>
        /**
         * Adobe Analytics
         *
         * Variables reported to Adobe Analytics:
         *  -pageName
         *  -server
         *  -channel
         *  -first minor section
         *  -second minor section (if available)
         *  -third minor section (if available)
         *  -full URL (domain + path + query string)
         *  -base URL (domain + path)
         *  -language
         *  -country
         *
         */

        /**
         * Additional JS files to be loaded BEFORE adobe-analytics.js:
         *
         * - http://www.redhat.com/j/s_code.js
         *
         * Additional JS files to be loaded AFTER adobe-analytics.js
         *
         * - http://www.redhat.com/j/rh_omni_footer.js
         */


        (function() {

            // Load the path name, without its initial /
            var arr = location.pathname.substr(1, location.pathname.length).toLowerCase().split('/');
            // If the path ends in index.html or whitespace, trim the array
            if (arr[arr.length - 1] == "index.html" || arr[arr.length - 1] == "" ) {
                arr.pop();
            }

            /*
             * Assign values to Adobe Analytics properties
             */

            s.channel = "apiman | "; // The channel is our top level classification
            s.server = "apiman"; // The server is ???
            s.pageName = "apiman |  | " + (arr[arr.length -1] || "homepage"); // pageName is apiman | <Channel> | {page_name}. {page_name} has index.html removed
            s.prop2 = s.eVar22 = "en"; // prop2/eVar22 is the ISO 639-1 language code
            s.prop4 = s.eVar23 = encodeURI(location.search); //prop4/eVar23 is the query string of the page

            // Pad the array as needed, so we can shift away later
            for (var i = arr.length; i < 3; i++) {
                arr[i] = "";
            }

            s.prop14 = s.eVar27 = arr.shift(); // prop14/eVar27 is the first minor section (normally /{minor_section_1})
            s.prop15 = s.eVar28 = arr.shift(); // prop15/eVar28 is the second minor section (normally /a/{minor_section_2})
            s.prop16 = s.eVar29 = arr.shift(); // prop16/eVar29 is the third minor section (normally /a/b/{minor_section_3})
            s.prop21 = s.eVar18 = encodeURI(location.hostname+location.pathname).toLowerCase(); // prop21/eVar18 is the URL, less any query strings or fragments
        })();
    </script>
    <script src="//www.redhat.com/assets/js/tracking/rh_omni_footer.js"/>
</footer>

      </div>
    </div>
  </body>
</html>
